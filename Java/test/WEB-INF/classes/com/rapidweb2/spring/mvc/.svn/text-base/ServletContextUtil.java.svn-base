/**
 * 项目名称：善行信息电子商务平台
 * 版权申明：善行信息公司，未经许可不得在任何软件中以任何形式使用全部或部分代码，不得更改本项目的代码。
 * 文件名称：ServletContextUtil.java
 * 创建时间：2010-12-31-上午10:49:58
 * 创建用户：hunting
 * 文件描述：
 * 修改记录：
 *   
 */
package com.rapidweb2.spring.mvc;

import java.io.File;

import javax.servlet.ServletContext;

import org.springframework.stereotype.Component;
import org.springframework.web.context.ServletContextAware;
import org.springframework.web.context.WebApplicationContext;
import org.springframework.web.context.support.WebApplicationContextUtils;

import com.rapidweb2.common.exception.WebException;

/**
 * ServletContext工具类,用来在SPRING MVC中获得容器<br>
 * 有两种使用方式：<br>
 * 1)、利用@Component让SPRING自己查找，例如：<br>
 * 
 * <pre>
 * 	<context:component-scan base-package="com.rapidweb2.spring.mvc"/>
 * </pre>
 * 
 * 2)、明确配置定义? TODO:需要测试是否是普通的BEAN定义？ （应该可以设置为APPLICATION级别）
 *  
 * 
 * @author hunting
 * 
 */

@Component
public class ServletContextUtil implements ServletContextAware {

	private static ServletContext servletContext;

	@Override
	public void setServletContext(ServletContext servletContext) {
		ServletContextUtil.servletContext = servletContext;
	}

	/**
	 * 获得当前的容器信息
	 * @return
	 */
	public static ServletContext getServletContext() {
		
		return servletContext;
	}

	/**
	 * 获得当前WEB的上下文环境
	 * @return
	 */
	public static WebApplicationContext getWebApplicationContext(){
		return WebApplicationContextUtils.getWebApplicationContext(servletContext);
	}
	
	/**
	 * 获得在WEB容器下对应资源的File对象，如果不存在则返回异常
	 * 
	 * @param path
	 * @return
	 */
	public static File getResourceFile(String path) {
		File f = new File(servletContext.getRealPath(path));
		if (f == null || !f.exists())
			throw new WebException("指定的文件/路径%s在WebContent下不存在", path);
		return f;
	}

}
