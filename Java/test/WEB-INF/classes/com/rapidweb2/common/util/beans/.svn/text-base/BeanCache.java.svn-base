/**
 * 项目名称：RapidWeb快速开发平台基础框架
 * 版权申明：RapidWeb项目组，未经许可不得在任何软件中以任何形式使用全部或部分代码，不得更改本项目的代码。
 * 文件名称：BeanCache.java
 * 创建时间：2009-12-23-下午11:15:02
 * 创建用户：chiyucheng(chis123@qq.com)
 * 文件描述：
 * 修改记录：
 *   
 */
package com.rapidweb2.common.util.beans;

import java.util.Map;

import com.google.common.collect.Maps;
import com.rapidweb2.common.util.BeanUtil;

/**
 * 解析的bean的缓存类
 * @author chis
 *
 */
public final class BeanCache {
	final private static Map<Class<?>,Map<String,BeanProperty>> beans = Maps.newHashMap();
	
	/**
	 * 将一个JAVABEAN解析缓存起来
	 * @param t
	 */
	public synchronized static Map<String,BeanProperty> set(Class<?> t){
		BeanProperty[] ps = BeanUtil.getProperties(t);
		Map<String,BeanProperty> bean = Maps.newHashMapWithExpectedSize( ps==null?1:ps.length);
//		Map<String,BeanProperty> bean = new HashMap<String,BeanProperty>( ps==null?1:ps.length );
		if( ps!=null )
			for( BeanProperty p : ps ) bean.put(p.getName(), p);
		
		beans.put(t,bean);
		return bean;
	}
	
	/**
	 * 获得某个类的属性定义。
	 * @param t
	 * @return
	 */
	public synchronized static Map<String,BeanProperty> get(Class<?> t){
		Map<String,BeanProperty> p = beans.get(t);
		if( p==null ) return set(t);
		return p;
	}
}
